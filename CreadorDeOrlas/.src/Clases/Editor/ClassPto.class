' Gambas class file

Property coeficiente As Float 
Private hcoeficiente As Float 

Private Function coeficiente_read() As Float 
  
  Return hcoeficiente 
  
End  

Private Sub coeficiente_write(Valor As Float)
  
  hcoeficiente = Valor 
  p.coeficiente = valor
  
End

Property tag As Object 'con esta variable "enlazo" el objeto al que pertenece 
Private htag As Object

Property x As Integer
Property y As Integer

Private hx As Integer
Private hy As Integer

Private p As ClassPtoControl

Public Sub dibuja()
  
End

Private Function x_Read() As Integer
  
  Return p.x
  
End

Private Sub x_Write(Value As Integer)
  
  p.x = value
  
End

Private Function y_Read() As Integer
  
  Return p.y
  
End

Private Sub y_Write(Value As Integer)
  
  p.y = value
  
End

Public Sub _new(AreaDibujo As DrawingArea, x0 As Integer, y0 As Integer, Optional colores As Integer)
  
  hy = y0
  hx = x0
  If colores = 0 Then 
    p = New ClassPtoControl(AreaDibujo, x0, y0, Color.green)
    
  Else
    p = New ClassPtoControl(AreaDibujo, x0, y0, Colores)
  Endif
  p.tag = Me 'para que guarde a quien pertenece el punto de control..
  
End

Public Function resumen() As String
  
  Dim contenido As String
  
  contenido = "[Punto]" & gb.cr
  contenido &= Str$(hx) & gb.cr
  contenido &= Str$(hy) & gb.cr
  Return contenido
  
End

Public Sub borrar(Optional obj As Object)
  
End

Private Function tag_Read() As Object
  
  Return htag
  
End

Private Sub tag_Write(Value As Object)
  
  htag = value
  
End

Public Sub ocultame()
  
  p.Visible = False
  
End
