' Gambas class file

Public listaTiposDeLetra As New ClassDatoLetra[] 'lista de letras que contiene el sistema

Public GridViewRegistrosAlumnos As ClassSuperGridview
Public Observador1 As Observer

Public GridViewRegistrosProfesores As ClassSuperGridview
Public Observador2 As Observer

Public Sub Form_Open()
  
  Dim pensando As New FormPensando 
  'comprobar si ya hay una instancia del programa ejecutandose...
  If ModuleUnicaVez.ejecutandoUnicaCopia("CreadorDeOrlas.gambas") <> True Then
    pensando.Show()
    Wait 0.5
    LabelVersion.text = "Versión: Beta " & Application.Version
    Me.center
    ModuleUpdate.comprobar("CreadorDeOrlas", Application.Version, "http://creadordeorlas.blogspot.com.es/2013/03/version.html", "no mensaje")
    
    ' ModulePruebas.escribe()
    comun.comprobarEntorno()
    'inicio el programa: creo directorios y copio archivos...
    ModulePrincipal.iniciarDirectorios()
    
    '  ModulePruebas.escribe()
    Print "hola iniciandome..."
    
    'feditor.plantillaActual = User.home & "/Imágenes/Orlas/ORLAplantillasAntonio/ORLAejemplo01/orla.svg"
    
    'crear gridview y sus observadores....para  diplomas tematicos, registros alumnos
    GridViewRegistrosAlumnos = New ClassSuperGridview(IconPanel1[3])
    Observador1 = New Observer(GridViewRegistrosAlumnos) As "ObservadorGridViewRegistrosAlumnos"
    
    GridViewRegistrosProfesores = New ClassSuperGridview(IconPanel1[4])
    Observador2 = New Observer(GridViewRegistrosProfesores) As "ObservadorGridViewRegistrosProfesores"
    
    ModuleIntermedio.IniciarGridViewRegistrosAlumnos(GridViewRegistrosAlumnos)
    ModuleIntermedio.IniciarGridViewRegistrosProfesoresores(GridViewRegistrosProfesores)
    
    'TODO: abrir un ejemplo inicial de orla
    ' 
    ' 
    pensando.parar = True
    pensando.Delete()
    
  Else
    'como ya hay una instancia de esta aplicacion abierta, salgo
    ModuleGestionAlumnos.guardado = True
    ModuleGestionProfesores.guardado = True
    ModuleGestionOrla.guardado = True
    Me.Close()
  Endif
  
End

Public Sub ButtonEditorOrla_Click()
  
  Dim esquemaprofesor As String = Str$(ModuleGestionProfesores.lista.Registros.Count) & "=" & Str$(ModuleGestionProfesores.lista.Registros.Count) 
  Dim feditor As New FMainEditor
  'Reemplaza la plantilla con los datos que ha introducido (colegio, curso,etc )
  
  '  ModuleDistribucionFotos.hacer(ValueBoxHorizontal.value, ValueBoxVertical.Value, ModuleGestionOrla.orla.Plantilla)
  
  ModuleDistribucionFotos.hacerGenerico("alumno", ModuleGestionAlumnos.lista.Registros, ValueBoxHorizontal.value, ValueBoxVertical.Value, ModuleGestionOrla.orla.Plantilla)
  
  ModuleDistribucionFotos.hacerGenerico("profesor", ModuleGestionProfesores.lista.Registros, ValueBoxHorizontal.value, ValueBoxVertical.Value, ModuleGestionOrla.orla.Plantilla, esquemaprofesor)
  
  'asigno nueva posicion de traslado
  feditor.esquema = LabelEsquema.Text
  feditor.esquemaprofesor = esquemaprofesor
  feditor.espacioancho = ValueBoxHorizontal.Value
  feditor.espaciolargo = ValueBoxVertical.Value
  feditor.listaProfesores = ModuleGestionProfesores.lista
  feditor.listaAlumnos = ModuleGestionAlumnos.lista
  FormPensando.show()
  Wait 0.5
  
  feditor.plantillaActual = User.home & "/temporal.orla/Detalles_en_azul_y_negro_marco.svg"
  feditor.ShowDialog()
  
End

Public Sub Label9_MouseDown()
  
  Desktop.Open("http://www.jsbsan.blogspot.com.es/")
  
End

Public Sub Label13_MouseDown()
  
  Desktop.Open("http://minino.galpon.org/es/descargas")  
  
End

Public Sub Label12_MouseDown()
  
  Desktop.Open("http://inkscape.org/")
  
End

Public Sub ToolButtonEditar3_Click()
  
  FormPlantillaOrla.Show()
  
End

Public Sub ToolButtonTipoLetraAlumno_Click()
  
  Dialog.font = LabelTipoAlumno.Font
  If Not Dialog.selectFont() Then 
    LabelTipoAlumno.text = Dialog.Font.name 
    LabelTipoAlumno.font = Dialog.Font
  Endif
  
End

Public Sub ToolButtonTipoLetraProfesor_Click()
  
  Dialog.font = LabelTipoProfesor.Font
  If Not Dialog.selectFont() Then 
    LabelTipoProfesor.text = Dialog.Font.name
    LabelTipoProfesor.font = Dialog.Font
  Endif
  
End

Public Sub ToolButtonCrear_Click()
  
  Dim respuesta As Integer
  
  If TextBoxNombreFicheroNuevo.Text = "" Then
    Message.Error("Necesita poner un nombre")
  Else
    'comprobar que si existe...
    If Not Exist(DirChooserElegirDirectorioCrearGrupo.Value & "/" & TextBoxNombreFicheroNuevo.text & ".Orla") Then
      
    Else
      respuesta = Message.Question("Existe el fichero:" & gb.CrLf & DirChooserElegirDirectorioCrearGrupo.Value & "/" & TextBoxNombreFicheroNuevo.text & gb.crlf & "¿que desea hacer?", " SobreEscribir ", " Cancelar ")
      If respuesta = 1 Then 
        
      Else
        'ha cancelado la operacion...
        Print "Cancelado Crear Grupo"
        
      Endif
      
    Endif
    
  Endif
  
End

Public Sub Label19_MouseDown()
  
End

Public Sub botontransparente_Click()
  
  Dim numero As Integer
  Dim ruta As String = modulePrincipal.RutaPrograma & "temporales/FotosPlantillaOrla/"
  
  numero = Val(Last.tag)
  ''TODO: Boton transparente definir...
  Select numero
    Case 1
      ModuleGestionOrla.orla.escudo01 = ModuleHacerTransparente.convertirTransparente(ruta & ModuleGestionOrla.orla.escudo01, modulePrincipal.RutaPrograma)
      PictureBoxFondo.Picture = Picture[ruta & ModuleGestionOrla.orla.escudo01]
      PictureBoxFondo.tag = ModuleGestionOrla.orla.escudo01
    Case 2
      ModuleGestionOrla.orla.escudo02 = ModuleHacerTransparente.convertirTransparente(ruta & ModuleGestionOrla.orla.escudo02, modulePrincipal.RutaPrograma)
      PictureBoxEscudo.Picture = Picture[ruta & ModuleGestionOrla.orla.escudo02]
      PictureBoxEscudo.tag = ModuleGestionOrla.orla.escudo02
    Case 3
      ModuleGestionOrla.orla.escudo03 = ModuleHacerTransparente.convertirTransparente(ruta & ModuleGestionOrla.orla.escudo03, modulePrincipal.RutaPrograma)
      PictureBoxLogo.Picture = Picture[ruta & ModuleGestionOrla.orla.escudo03]
      PictureBoxLogo.tag = ModuleGestionOrla.orla.escudo03
    Case 4
      ModuleGestionOrla.orla.escudo04 = ModuleHacerTransparente.convertirTransparente(ruta & ModuleGestionOrla.orla.escudo04, modulePrincipal.RutaPrograma)
      PictureBoxLogo2.Picture = Picture[ruta & ModuleGestionOrla.orla.escudo04]
      PictureBoxLogo2.tag = ModuleGestionOrla.orla.escudo04
    Case 5
      
  End Select
  
End

Public Sub PictureBoxFondo_MouseDown()
  
  ModuleGestionOrla.orla.escudo01 = ModuleAsignarYSoltarImagenes.asignaImagen(PictureBoxFondo, modulePrincipal.RutaPrograma & "temporales/FotosPlantillaOrla/")
  PictureBoxFondo.tag = ModuleGestionOrla.orla.escudo01
  
End

Public Sub PictureBoxEscudo_MouseDown()
  
  ModuleGestionOrla.orla.escudo02 = ModuleAsignarYSoltarImagenes.asignaImagen(PictureBoxEscudo, modulePrincipal.RutaPrograma & "temporales/FotosPlantillaOrla/")
  PictureBoxEscudo.Tag = ModuleGestionOrla.orla.escudo02 
  
End

Public Sub PictureBoxLogo_MouseDown()
  
  ModuleGestionOrla.orla.escudo03 = ModuleAsignarYSoltarImagenes.asignaImagen(PictureBoxLogo, modulePrincipal.RutaPrograma & "temporales/FotosPlantillaOrla/")
  PictureBoxLogo.Tag = ModuleGestionOrla.orla.escudo03
  
End

Public Sub PictureBoxLogo2_MouseDown()
  
  ModuleGestionOrla.orla.escudo04 = ModuleAsignarYSoltarImagenes.asignaImagen(PictureBoxLogo2, modulePrincipal.RutaPrograma & "temporales/FotosPlantillaOrla/")
  PictureBoxLogo2.Tag = ModuleGestionOrla.orla.escudo04
  
End

'------------------------------- Asignar Imagen ---------------------
Private Sub asignaImagen(PictureBoxElegido As Picturebox) As String
  
  Dim dialogofile As New FormElegirFichero
  Dim dat As New ClassDato
  
  dialogofile.valor = dat
  
  dialogofile.Titulo = ("Elija el archivo gráfico")
  dialogofile.Filtro = ["*.png;*.jpg;*.jpeg;*.bmp", ("Ficheros de Imágenes")]
  dialogofile.ShowModal()
  
  If dat.dato = "-1" Then Return
  
  Return asignaImagen2Paso(dat.dato, PictureBoxElegido)
  
End

Private Function asignaImagen2Paso(ruta As String, PictureBoxElegido As Picturebox) As String
  
  Dim nombrecopia As String
  Dim extension As String
  Dim comparacion As String 'añadido para comprobar si existe un fichero con el mismo nombre y es igual
  Dim copiar As String
  Dim comando As String
  Dim nombresimple As String
  
  If Not Exist(ruta) Then
    Message.Info(("No se ha podido descargarse el archivo")) 
    Return 
  Endif
  
  PictureBoxElegido.Picture = Picture["importar.png"]
  Wait 0.1
  PictureBoxElegido.Picture = Picture[ruta]
  PictureBoxElegido.tag = ruta
  copiar = "si"
  
  nombresimple = ModuleUtilidadesDisco.VerificarNombreEtiqueta(Replace(ModuleUtilidadesDisco.extraedesdebarra(PictureBoxElegido.tag), " ", "_"), ["FOTO", "PLANTILLA", "CAMPO"], ["Imagen", "PLA_TILLA", "CA_PO"])
  ''TODO: MODIFICAR RUTA...
  nombrecopia = ModulePrincipal.RutaPrograma & "temporales/FotosPlantillasTematica/" & nombresimple
  
  While (Exist(nombrecopia))
    'si existe fichero con el mismo nombre, 1º comprobar si es igual...
    comando = "cmp " & nombrecopia & " " & PictureBoxElegido.tag
    Shell comando To comparacion
    If comparacion = "" Then 
      'son iguales-> no hace falta cambiar de nombre ya que lo tengo...
      'no hago la copia
      copiar = "no"
      
      Break
    Endif
    
    'para que no machaque nombres de fichros...
    extension = ModuleUtilidadesDisco.extraeExtension(nombrecopia)
    If extension <> "" Then 
      nombrecopia = Mid$(nombrecopia, 1, Len(nombrecopia) - Len(extension) - 1) & "c" & "." & extension
      copiar = "si"
    Else
      nombrecopia = Mid$(nombrecopia, 1, Len(nombrecopia) - Len(extension)) & "c" 
      copiar = "si"
    Endif
    
  Wend
  
  If copiar = "si" Then 
    
    Exec ["cp", PictureBoxElegido.tag, nombrecopia] Wait
    PictureBoxElegido.Picture = Picture["importar.png"]
    Wait 0.1
    PictureBoxElegido.Picture = Picture[nombrecopia]
    PictureBoxElegido.tag = nombrecopia
    
  Endif
  
  Return ModuleUtilidadesDisco.extraedesdebarra(nombrecopia)
  
End

'--------------------------------------------------------------------------------------------------
''TODO: EDITAR AL HACER CLICK EN LOS GRIDVIEWS
'--------------------------------------------------------------------------------------------------

Public Sub ObservadorGridViewRegistrosAlumnos_DblClick()
  
  ToolButtonEditar_Click()
  
End

Public Sub ToolButtonEditar_Click()
  
  'TODO: editar alumnos
  Dim fregistro As New FormAlumno
  
  If GridViewRegistrosAlumnos.indice.Count > GridViewRegistrosAlumnos.row And GridViewRegistrosAlumnos.row > -1 Then 
    fregistro.modo = GridViewRegistrosAlumnos.indice[GridViewRegistrosAlumnos.row]
    fregistro.reg.Foto = ModuleGestionAlumnos.lista.Registros[fregistro.modo].Foto
    
    fregistro.reg.Nombre = GridViewRegistrosAlumnos[GridViewRegistrosAlumnos.row, 1].text
    fregistro.reg.Apellidos = GridViewRegistrosAlumnos[GridViewRegistrosAlumnos.row, 2].text
    fregistro.reg.Orden = GridViewRegistrosAlumnos[GridViewRegistrosAlumnos.row, 3].text
    fregistro.reg.Pueblo = GridViewRegistrosAlumnos[GridViewRegistrosAlumnos.row, 4].text
    fregistro.reg.Provincia = GridViewRegistrosAlumnos[GridViewRegistrosAlumnos.row, 5].text
    
    fregistro.ShowModal()
    ModuleIntermedio.rellenarGridviewsAlumnos(GridViewRegistrosAlumnos, ModuleGestionAlumnos.lista)
  Else
    Message.Info(("No se puede editar un registro vacío"))
  Endif
  
End

'------------------------------------------------------
'Boton Salir
'-------------------------------------------------------
Public Sub Form_Close()
  
  If ModuleGestionAlumnos.Guardado = False Or ModuleGestionProfesores.guardado = False Or ModuleGestionOrla.guardado = False Then 
    If Message.Warning(("¿Seguro que desea cerrar?") & "\n" & ("Todos cambios no guardados se perderan"),
        ("Cerrar"), ("Cancelar")) = 1 Then
      Me.Close
    Else
      Stop Event
      
    Endif
  Endif
  
End

'--------------------------------------------------------------------------------------------------
''TODO:  IconPanel1_Click()
'--------------------------------------------------------------------------------------------------
Public Sub IconPanel1_Click()
  
  Dim resultado As Boolean
  
  Print "Opcion elegida: ", IconPanel1.Index 
  
  If IconPanel1.Index = 11 Then Me.Close
  
  'ver datos de alumnos...
  If IconPanel1.Index = 3 Then 
    ModuleIntermedio.rellenarGridviewsAlumnos(GridViewRegistrosAlumnos, ModuleGestionAlumnos.lista)
    Return 
  Endif
  
  'ver datos de profesores...
  If IconPanel1.Index = 4 Then 
    ModuleIntermedio.rellenarGridviewsProfesores(GridViewRegistrosProfesores, ModuleGestionProfesores.lista)
    Return 
  Endif
  
  'Ver datos de orlas
  If IconPanel1.Index = 5 Then 
    rellenarDatosOrlas()
    ToolButtonAutomatica_Click()
    Return
  Endif
  
End

Public Sub TextBoxColegio_LostFocus()
  
  ModuleGestionOrla.orla.colegio = TextBoxColegio.text 
  
End

Public Sub TextBox2Clase_LostFocus()
  
  ModuleGestionOrla.orla.clase = TextBox2Clase.text 
  
End

Public Sub TextBoxCurso_LostFocus()
  
  ModuleGestionOrla.orla.curso = TextBoxCurso.text
  
End

Public Sub TextBoxOpcional_LostFocus()
  
  ModuleGestionOrla.orla.textoopcional01 = TextBoxOpcional.text
  
End

Public Sub TextBoxOpcional2_LostFocus()
  
  ModuleGestionOrla.orla.textoopcional02 = TextBoxOpcional2.text 
  
End

Public Sub ComboBoxPlantillaUsar_LostFocus()
  
  ModuleGestionOrla.orla.Plantilla = ComboBoxPlantillaUsar.text
  
End

Public Sub ToolButtonAnnadir_Click()
  
  Dim fregistro As New FormAlumno
  Dim regtemp As New ClassAlumno
  
  fregistro.modo = fregistro.anadir
  
  fregistro.reg = regtemp
  
  fregistro.ShowModal()
  ModuleIntermedio.rellenarGridviewsAlumnos(GridViewRegistrosAlumnos, ModuleGestionAlumnos.lista)
  
  regtemp = Null
  
End
'----------------------------------------------------------------------------
' Rellenar datos de Orlas
'----------------------------------------------------------------------------

Public Sub rellenarDatosOrlas()
  
  Dim ruta As String = modulePrincipal.RutaPrograma & "temporales/FotosPlantillaOrla/"
  
  TextBoxColegio.text = ModuleGestionOrla.orla.colegio
  TextBox2Clase.text = ModuleGestionOrla.orla.clase
  TextBoxCurso.text = ModuleGestionOrla.orla.curso
  TextBoxOpcional.text = ModuleGestionOrla.orla.textoopcional01
  If ModuleGestionOrla.orla.Plantilla <> "" Then 
    ComboBoxPlantillaUsar.text = ModuleGestionOrla.orla.Plantilla
  Else
    ComboBoxPlantillaUsar.text = User.home & "/CreadorOrlas/plantillasOrla/orla2/Naranja_Floral.svg"
    ModuleGestionOrla.orla.Plantilla = User.home & "/CreadorOrlas/plantillasOrla/orla2/Naranja_Floral.svg"
  Endif
  
  TextBoxOpcional2.text = ModuleGestionOrla.orla.textoopcional02
  
  If ModuleGestionOrla.orla.escudo01 <> "" Then PictureBoxFondo.Picture = Picture[ruta & ModuleGestionOrla.orla.escudo01]
  If ModuleGestionOrla.orla.escudo02 <> "" Then PictureBoxEscudo.Picture = Picture[ruta & ModuleGestionOrla.orla.escudo02]
  If ModuleGestionOrla.orla.escudo03 <> "" Then PictureBoxLogo.Picture = Picture[ruta & ModuleGestionOrla.orla.escudo03]
  If ModuleGestionOrla.orla.escudo04 <> "" Then PictureBoxLogo2.Picture = Picture[ruta & ModuleGestionOrla.orla.escudo04]
  
  SpinBoxFilas.value = ModuleGestionOrla.orla.NumeroFilasAlumnos
  
  If ModuleGestionOrla.orla.OrdenAlfabeticoAlumnos = True Then 
    RadioButtonAlumnoAlfabetico.value = True
    RadioButtonAlumnoIndicado.value = False
  Else
    RadioButtonAlumnoAlfabetico.value = False
    RadioButtonAlumnoIndicado.value = True
  Endif 
  
  If ModuleGestionOrla.orla.OrdenAlfabeticoProfesores = True Then 
    
    RadioButtonProfesorAlfabetico.value = True
    RadioButtonProfesorIndicado.value = False
  Else
    RadioButtonProfesorAlfabetico.value = False
    RadioButtonProfesorIndicado.value = True
  Endif 
  
  ValueBoxHorizontal.value = ModuleGestionOrla.orla.EspacioEntreFotosHorizontal
  ValueBoxVertical.value = ModuleGestionOrla.orla.EspacioEntreFotosVertical
  ValueBoxEscalaProfesores.value = ModuleGestionOrla.orla.EscalaFotosProfesores
  ValueBoxEscalaAlumnos.value = ModuleGestionOrla.orla.EscalaFotosAlumnos
  
  'TODO: Aqui ver tipo de letra que se le asigna
  'LabelTipoProfesor.Font = ModuleGestionOrla.orla.LetraProfesor
  ' LabelTipoAlumno.font = ModuleGestionOrla.orla.LetraProfesor  
  
End

Public Sub ToolButtonAnnadir2_Click()
  
  Dim fregistro As New FormProfesor
  Dim regtemp As New ClassProfesor
  
  fregistro.modo = fregistro.anadir
  
  fregistro.reg = regtemp
  
  fregistro.ShowModal()
  ModuleIntermedio.rellenarGridviewsProfesores(GridViewRegistrosProfesores, ModuleGestionProfesores.lista)
  
  regtemp = Null
  
End

Public Sub ToolButtonEditar2_Click()
  
  Dim fregistro As New FormProfesor
  Dim regtemp As New ClassProfesor
  
  If GridViewRegistrosProfesores.indice.Count > GridViewRegistrosProfesores.row And GridViewRegistrosProfesores.row > -1 Then 
    fregistro.modo = GridViewRegistrosProfesores.indice[GridViewRegistrosProfesores.row]
    fregistro.reg.Foto = ModuleGestionProfesores.lista.Registros[fregistro.modo].Foto
    
    fregistro.reg.Nombre = GridViewRegistrosProfesores[GridViewRegistrosProfesores.row, 1].text
    fregistro.reg.Apellidos = GridViewRegistrosProfesores[GridViewRegistrosProfesores.row, 2].text
    fregistro.reg.Orden = GridViewRegistrosProfesores[GridViewRegistrosProfesores.row, 3].text
    fregistro.reg.Asignatura = GridViewRegistrosProfesores[GridViewRegistrosProfesores.row, 4].text
    fregistro.ShowModal()
    ModuleIntermedio.rellenarGridviewsProfesores(GridViewRegistrosProfesores, ModuleGestionProfesores.lista)
  Else
    Message.Info(("No se puede editar un registro vacío"))
    
  Endif
  
End

Public Sub ToolButtonBorrar2_Click()
  
  Dim res As Integer
  
  If GridViewRegistrosProfesores.indice.count > GridViewRegistrosProfesores.row Then 
    res = Message.Question(("Seguro que desea borrar.."), ("Si"), ("Cancelar"))
    If res = 1 Then 
      'refrescar el gridviews
      ModuleGestionProfesores.BorrarRegistro(GridViewRegistrosProfesores.indice[GridViewRegistrosProfesores.row])
      ModuleIntermedio.rellenarGridviewsProfesores(GridViewRegistrosProfesores, ModuleGestionProfesores.lista)
    Endif
  Endif
  
End

Public Sub ToolButtonBorrar_Click()
  
  Dim res As Integer
  
  If GridViewRegistrosAlumnos.indice.count > GridViewRegistrosAlumnos.row Then 
    res = Message.Question(("Seguro que desea borrar.."), ("Si"), ("Cancelar"))
    If res = 1 Then 
      'refrescar el gridviews
      ModuleGestionAlumnos.BorrarRegistro(GridViewRegistrosAlumnos.indice[GridViewRegistrosAlumnos.row])
      ModuleIntermedio.rellenarGridviewsAlumnos(GridViewRegistrosAlumnos, ModuleGestionAlumnos.lista)
    Endif
  Endif
  
End

Public Sub ToolButtonAutomatica_Click()
  
  Dim a As Integer
  'calcular el numero de filas necesarias para el numero de alumnos
  SpinBoxFilas.Value = ModuleExtraerDatosOrla.calculoDeFilas(ModuleGestionAlumnos.lista.Registros.Count) 
  
  LabelEsquema.text = ModuleSistemaOrdenacion.Esquema(ModuleGestionAlumnos.lista.Registros.Count, SpinBoxFilas.Value)
  
  'prueba
  'For a = 1 To 110
  '  SpinBoxFilas.Value = Int((a) ^ (1 / 2.5))
  
  '  Print a, ModuleSistemaOrdenacion.Esquema(a, SpinBoxFilas.Value)
  'Next
  
End

Public Sub ToolButtonGenerarOrla_Click()
  
  ModuleGenerarPdf.realizar(ModulePrincipal.RutaPrograma & "trabajotmp/")
  
End

Public Sub ToolButtonGeneraSVG_Click()
  
  Try Copy User.home & "/CreadorOrlas/plantillasOrla/orla2/Naranja_Floral.svg" To ModulePrincipal.RutaPrograma & "trabajotmp/" & "plantillatmp.svg"
  ModuleGenerarSVG.realizar(ModulePrincipal.RutaPrograma & "trabajotmp/" & "plantillatmp.svg")
  
End

Public Sub RadioButtonEfecto_Click()
  
  If RadioButtonEfecto.Value = True Then 
    PictureBoxMarco.Picture = Picture.Load(ModuleGenerarFotos.ponerMarco(modulePrincipal.alumno93, True, ColorButton1.Value))
  Endif
  
End

Public Sub ButtonRedibujaMarco_Click()
  
  PictureBoxMarco.Picture = Picture.Load(ModuleGenerarFotos.ponerMarco(modulePrincipal.alumno93, True, ColorButton1.Value))
  PictureBoxMarco.Refresh()
  'Wait 0.1
  
End

Public Sub RadioButtonEfectoCuna_Click()
  
  If RadioButtonEfectoCuna.Value = True Then 
    PictureBoxCuna.Picture = Picture.Load(ModuleGenerarFotos.SuperPonerForma(modulePrincipal.formaCuna, ModulePrincipal.alumno93, "/tmp/conversion.png"))
  Endif
  
End

Public Sub RadioButtonEfectoV_Click()
  
  If RadioButtonEfectoV.Value = True Then 
    PictureBoxV.Picture = Picture.Load(ModuleGenerarFotos.SuperPonerForma(modulePrincipal.formaV, ModulePrincipal.alumno93, "/tmp/conversion.png"))
  Endif  
  
End

Public Sub RadioButtonEfectoElipse_Click()
  
  If RadioButtonEfectoElipse.Value = True Then 
    
    PictureBoxElipse.Picture = Picture.Load(ModuleGenerarFotos.SuperPonerForma(modulePrincipal.formaElipse, ModulePrincipal.alumno93, "/tmp/conversion.png"))
    
  Endif
  
End
